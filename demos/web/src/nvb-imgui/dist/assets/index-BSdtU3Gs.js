var at=Object.defineProperty;var ct=(f,t,o)=>t in f?at(f,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[t]=o;var r=(f,t,o)=>ct(f,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}})();class ht{constructor(t,o,i,e,s){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"text");r(this,"text_size");r(this,"state");t.font=n.label.font_size+"px "+n.font,t.textBaseline="middle";const l=t.measureText(s),a=l.width,h=l.fontBoundingBoxAscent+l.fontBoundingBoxDescent;this.bbox={left:e.x,top:e.y,right:e.x+a,bottom:e.y+h},this.text=s,this.action_type=o,this.text_size=n.label.font_size,this.state=0,this.loc=i}render(t){let o=b.string(b.white);this.state==1&&(o=n.widget.hover_bg_color),t.font=this.text_size+"px "+n.font,t.fillStyle=o,t.textBaseline="middle",t.textAlign="center";const i=(this.bbox.left+this.bbox.right)/2,e=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.text,i,e)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y];return m.isInside(this.bbox,o,i)&&this.action_type!=null&&(this.state=1),this.state==1?{wants_focus:t.mouse_frame.clicked,action:this.action_type}:{wants_focus:!1,action:null}}}var M=(f=>(f[f.default=0]="default",f[f.hovered=1]="hovered",f[f.clicked=2]="clicked",f[f.down=3]="down",f[f.released=4]="released",f))(M||{});class it{constructor(t,o,i,e,s,l,a){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"text");r(this,"state");t.font=n.button.font_size+"px "+n.font,t.textBaseline="middle";const h=t.measureText(s),w=h.width+2*n.button.padding,u=l!=null&&l>w?l:w,x=h.fontBoundingBoxAscent+h.fontBoundingBoxDescent+2*n.button.padding,k=a!=null&&a>x?a:x;this.bbox={left:e.x,top:e.y,right:e.x+u,bottom:e.y+k},this.text=s,this.action_type=o,this.state=0,this.loc=i}render(t){let o=n.widget.default_bg_color;this.state==1&&(o=n.widget.hover_bg_color),this.state==2&&(o=n.widget.down_bg_color),this.state==3&&(o=n.widget.down_bg_color),this.state==4&&(o=n.widget.down_bg_color),t.fillStyle=o,t.fillRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),t.font=`normal ${n.button.font_size}px ${n.font}`,t.fillStyle=b.string(b.white),t.textBaseline="middle",t.textAlign="center";const i=(this.bbox.left+this.bbox.right)/2,e=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.text,i,e)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y];if(m.isInside(this.bbox,o,i)){const e=JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc);t.mouse_frame.clicked?(this.state=2,t.active_widget_loc=JSON.parse(JSON.stringify(this.loc))):e&&t.mouse_frame.released?this.state=4:e&&t.mouse_down?this.state=3:this.state=1}return this.state==2||this.state==3?{wants_focus:!0,action:null}:this.state==4?{wants_focus:!1,action:this.action_type}:{wants_focus:!1,action:null}}}class st{constructor(t,o,i,e,s,l){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"text");r(this,"state");t.font=n.button.font_size+"px "+n.font,t.textBaseline="middle";const a=t.measureText(s),h=a.width,w=a.fontBoundingBoxAscent+a.fontBoundingBoxDescent;this.bbox={left:e.x,top:e.y,right:e.x+(l||h+2*n.button.padding),bottom:e.y+w+2*n.button.padding},this.text=s,this.action_type=o,this.state=0,this.loc=i}render(t){let o=n.widget.default_bg_color;this.state==1&&(o=n.widget.hover_bg_color),this.state==2&&(o=n.widget.down_bg_color),this.state==3&&(o=n.widget.down_bg_color),this.state==4&&(o=n.widget.down_bg_color),t.fillStyle=o,t.fillRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),t.font="lighter "+n.button.font_size+"px "+n.font,t.fillStyle=b.string(b.white),t.textBaseline="middle",t.textAlign="center";const i=Math.round((this.bbox.left+this.bbox.right)/2)+.5,e=Math.round((this.bbox.top+this.bbox.bottom)/2)+1;t.fillText(this.text,i,e)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y],e=m.isInside(this.bbox,o,i);return e&&t.mouse_frame.clicked?(this.state=2,t.active_widget_loc=JSON.parse(JSON.stringify(this.loc))):JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_frame.released?this.state=4:JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_down?this.state=3:e&&(this.state=1),this.state==2||this.state==3?{wants_focus:!0,action:this.action_type}:this.state==4?{wants_focus:!1,action:null}:{wants_focus:!1,action:null}}}class dt{constructor(t,o,i,e,s,l){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"text");r(this,"text_size");r(this,"max_width");r(this,"state");r(this,"wrapped_lines");t.font=n.text.font_size+"px "+n.font,t.textBaseline="middle",this.max_width=l,this.text=s,this.action_type=o,this.text_size=n.text.font_size,this.state=0,this.loc=i,this.wrapped_lines=this.wrapText(t,s,l);let a=0;for(let u=0;u<this.wrapped_lines.length;u++){const x=t.measureText(this.wrapped_lines[u]).width;a<x&&(a=x)}const h=this.text_size*n.text.text_height_mult,w=this.wrapped_lines.length*h;this.bbox={left:e.x,top:e.y,right:e.x+a,bottom:e.y+w}}wrapText(t,o,i){const e=o.split(" "),s=[];let l="";for(let a of e){const h=l+(l?" ":"")+a;t.measureText(h).width>i?(l&&s.push(l),l=a):l=h}return l&&s.push(l),s}render(t){let o=b.string(b.white);this.state==1&&(o=n.widget.hover_bg_color),t.font=this.text_size+"px "+n.font,t.fillStyle=o,t.textBaseline="middle",t.textAlign="left";const i=this.text_size*1.2;let e=this.bbox.top+i/2;for(let s of this.wrapped_lines){const l=this.bbox.left;t.fillText(s,l,e),e+=i}}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y];return m.isInside(this.bbox,o,i)&&this.action_type!=null&&(this.state=1),this.state==1?{wants_focus:t.mouse_frame.clicked,action:this.action_type}:{wants_focus:!1,action:null}}}class mt{constructor(t,o,i,e,s,l){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"color");this.color=e,this.bbox={left:i.x,top:i.y,right:i.x+s,bottom:i.y+l},this.action_type=t,this.loc=o}render(t){const o=m.calcWidth(this.bbox),i=m.calcHeight(this.bbox),e=b.toHSVA(this.color),s={h:e.h,s:e.s,v:e.v,a:e.a};s.s=1,s.v=1;const l=b.string(b.fromHSVA(s.h,s.s,s.v,s.a)),a=t.createLinearGradient(this.bbox.left,this.bbox.top,this.bbox.right,this.bbox.top);a.addColorStop(0,"white"),a.addColorStop(1,l),t.fillStyle=a,t.fillRect(this.bbox.left,this.bbox.top,o,i);const h=t.createLinearGradient(this.bbox.left,this.bbox.top,this.bbox.left,this.bbox.bottom);h.addColorStop(0,"rgba(0, 0, 0, 0)"),h.addColorStop(1,"rgba(0, 0, 0, 1)"),t.fillStyle=h,t.fillRect(this.bbox.left,this.bbox.top,o,i);const w=e.s*o+this.bbox.left,u=(1-e.v)*i+this.bbox.top;t.beginPath(),t.arc(w,u,5,0,2*Math.PI),t.fillStyle=b.string(this.color),t.fill(),t.lineWidth=3,t.strokeStyle="black",t.stroke(),t.lineWidth=2,t.strokeStyle="white",t.stroke(),t.closePath()}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y];if(m.isInside(this.bbox,o,i)&&t.mouse_frame.clicked&&(t.active_widget_loc=this.loc),JSON.stringify(t.active_widget_loc)==JSON.stringify(this.loc)&&t.mouse_down){const l=m.calcWidth(this.bbox),a=m.calcHeight(this.bbox),h=B=>Math.min(Math.max(B,.0015),.999),w=h((o-this.bbox.left)/l),u=h(1-(i-this.bbox.top)/a),x=b.toHSVA(this.color);let k;if(u===0)k=b.fromHSVA(x.h,w,0,this.color.a);else if(w===0)k=b.fromHSVA(x.h,0,u,this.color.a);else{const B=b.toHSVA(this.color);k=b.fromHSVA(B.h,w,u,this.color.a)}return this.color=k,t.action_ret_var=this.color,{wants_focus:!0,action:this.action_type}}return{wants_focus:!1,action:null}}}class P{constructor(t,o,i,e,s,l){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"widgets");r(this,"cursor");this.cursor={x:i+n.layout_commons.padding,y:e},this.bbox={left:i,top:e,right:i+s,bottom:e+l},this.action_type=t,this.loc=o,this.widgets=[]}pushWidget(t){this.widgets.push(t)}render(t){for(let o=this.widgets.length-1;o>=0;o--)this.widgets[o].render(t)}requestAction(t){const o=l=>{if(t.active_widget_loc.length===0)return!0;const a=t.active_widget_loc.slice(0,l.loc.length);return a.length===l.loc.length&&a.every((h,w)=>h===l.loc[w])},[i,e]=[t.mouse_position.x,t.mouse_position.y],s=m.isInside(this.bbox,i,e);if(!s&&t.active_widget_loc.length==0)return{iters:null,wants_focus:!1,action:null};if(!t.moving_window)for(let l=0;l<this.widgets.length;l++){const a=this.widgets[l];if(!o(a))continue;const h=a.requestAction(t);if(h.wants_focus||h.action!=null||!(a instanceof P)&&m.isInside(a.bbox,i,e)&&a.action_type!=null&&!(a instanceof F))return{iters:l,wants_focus:h.wants_focus,action:h.action}}return t.active_widget_loc.length>1&&JSON.stringify(t.active_widget_loc)!=JSON.stringify(this.loc)?(t.active_widget_loc=[],{iters:null,wants_focus:!1,action:null}):this.action_type==null?{iters:null,wants_focus:!1,action:null}:(s&&t.mouse_frame.clicked&&(t.moving_window=!0,t.active_widget_loc=this.loc),t.moving_window&&t.mouse_frame.released&&(t.moving_window=!1,t.active_widget_loc=[]),{iters:null,wants_focus:!1,action:null})}makeLabel(t,o,i){const e=new ht(t,o,this.loc.concat([this.widgets.length]),this.cursor,i);return this.pushWidget(e),e}makeButton(t,o,i,e){const s=new it(t,o,this.loc.concat([this.widgets.length]),this.cursor,i,e==null?void 0:e.width,e==null?void 0:e.height);return this.pushWidget(s),s}makeDraggable(t,o,i,e){const s=new st(t,o,this.loc.concat([this.widgets.length]),this.cursor,i,e==null?void 0:e.width);return this.pushWidget(s),s}makeText(t,o,i,e){const s=new dt(t,o,this.loc.concat([this.widgets.length]),this.cursor,i,e??m.calcWidth(this.bbox)-2*n.layout_commons.padding);return this.pushWidget(s),s}makeColorPickerRect(t,o,i,e){const s=new mt(t,this.loc.concat([this.widgets.length]),this.cursor,o,i,e);return this.pushWidget(s),s}resetCursor(){this.cursor.x=this.bbox.left+2*n.layout_commons.widget_gap,this.cursor.y=this.widgets[this.widgets.length-1].bbox.bottom+n.layout_commons.widget_gap}}class F{constructor(t,o,i,e,s,l){r(this,"bbox");r(this,"action_type");r(this,"loc");r(this,"widgets");r(this,"title");r(this,"title_font_size");r(this,"window_state");this.action_type=o,this.title=i,this.title_font_size=n.header_commons.font_size,this.bbox={left:e,top:s,right:e+l,bottom:s+1.4*n.header_commons.font_size},this.loc=t,this.widgets=[],this.window_state="open"}render(t){t.fillStyle=this.window_state=="open"?n.header_commons.bg_color:n.window.minimized_header_bg,t.fillRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),t.font=this.title_font_size+"px "+n.font,t.fillStyle=n.header_commons.color,t.textBaseline="middle",t.textAlign="left";const o=this.bbox.left+n.layout_commons.widget_gap,i=(this.bbox.top+this.bbox.bottom)/2;t.fillText(this.title,o,i)}requestAction(t){if(this.action_type==null)return{wants_focus:!1,action:null};const[o,i]=[t.mouse_position.x,t.mouse_position.y];return m.isInside(this.bbox,o,i)&&t.mouse_frame.double_clicked?{wants_focus:!1,action:this.action_type}:{wants_focus:!1,action:null}}}class U extends st{constructor(t,o,i,e,s){super(t,o,i,e,s)}}class X extends it{constructor(t,o,i,e){super(t,o,i,e,"x")}render(t){let o=n.widget.default_bg_color;this.state==M.hovered&&(o=n.widget.hover_bg_color),this.state==M.clicked&&(o=n.widget.down_bg_color),this.state==M.down&&(o=n.widget.down_bg_color),this.state==M.released&&(o=n.widget.down_bg_color);const i=(this.bbox.left+this.bbox.right)/2;let e=(this.bbox.top+this.bbox.bottom)/2;e+=n.button.font_size*.1,t.fillStyle=o,t.beginPath(),t.arc(i,e,.5*n.button.font_size,0,2*Math.PI),t.fill(),t.closePath(),t.font=`normal ${1.25*n.button.font_size}px ${n.font}`,t.fillStyle=b.string(b.white),t.textBaseline="middle",t.textAlign="center",t.fillText(this.text,i,e)}}class q extends P{constructor(o,i,e,s,l,a,h,w,u,x,k,B){super(i,a,h,w,u,x);r(this,"min_size");r(this,"header_height");r(this,"offset");r(this,"mode");r(this,"tools");this.offset=0,this.mode="normal",this.tools={min_width:0,max_width:m.calcWidth(this.bbox)};const T=this.loc.concat([]);T.push(this.widgets.length),s!=null&&this.widgets.push(new U(o,s,T,{x:this.bbox.right-27,y:this.bbox.bottom-20},"res"));const V=this.loc.concat([]);V.push(this.widgets.length),l!=null&&this.widgets.push(new X(o,l,V,{x:this.bbox.right-15,y:this.bbox.top-2.5}));const N=a.concat([]);N.push(this.widgets.length);const L=new F(N,e,k,this.cursor.x,this.cursor.y,10);this.widgets.push(L),this.cursor.y+=m.calcHeight(L.bbox)+n.layout_commons.widget_gap,this.header_height=m.calcHeight(L.bbox),this.min_size=B,L.bbox.left=this.bbox.left,L.bbox.right=this.bbox.right}updateBBox(){}setMode(o,i){switch(this.mode=o,this.mode){case"normal":break;case"two columns":this.offset=this.widgets.length,i!=null&&(this.tools.min_width=i.min_width!=null?i.min_width:this.tools.min_width,this.tools.max_width=i.max_width!=null?i.max_width:this.tools.max_width);break}}pushWidget(o){switch(super.pushWidget(o),this.mode){case"normal":this.cursor.y+=m.calcHeight(o.bbox)+n.layout_commons.widget_gap;break;case"two columns":if((this.widgets.length-this.offset)%2==0){this.cursor.x=this.bbox.left+n.layout_commons.padding;const i=this.widgets.length-1,e=Math.max(m.calcHeight(this.widgets[i].bbox),m.calcHeight(this.widgets[i-1].bbox));this.cursor.y+=e+n.layout_commons.widget_gap}else this.cursor.x+=Math.min(this.tools.max_width,Math.max(this.tools.min_width,m.calcWidth(this.bbox)))/2;break}}render(o){o.save();const i=n.layout_commons.border_width;o.beginPath(),o.rect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),o.closePath(),o.fillStyle=b.string(n.layout_commons.bg_color),o.fillRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),o.strokeStyle=n.layout_commons.border,o.lineWidth=i,o.strokeRect(this.bbox.left-.5*i,this.bbox.top-.5*i,m.calcWidth(this.bbox)+i,m.calcHeight(this.bbox)+i),o.clip(),super.render(o),o.restore()}requestAction(o){return o.mouse_position.x,{minimise:!1,close:!1,resize:!1,iters:null,wants_focus:!1,action:null}}requestWindowAction(o,i){const e=super.requestAction(i);return e.iters==null?{minimise:!1,close:!1,resize:!1,...e}:this.widgets[e.iters]instanceof F?{minimise:e.action!=null,close:!1,resize:!1,...e}:this.widgets[e.iters]instanceof U&&!o?{minimise:!1,close:!1,resize:e.action!=null,...e}:this.widgets[e.iters]instanceof X?{minimise:!1,close:e.action!=null,resize:!1,...e}:o?{minimise:!1,close:!1,resize:!1,iters:null,wants_focus:!1,action:null}:{minimise:!1,close:!1,resize:!1,...e}}}class bt extends P{constructor(o,i,e,s,l,a){super(o,i,e,s,l,0);r(this,"columns");this.columns=a}updateBBox(o){const i=n.layout_commons.padding;o.bbox.top<this.bbox.top+i&&(this.bbox.top=o.bbox.top-i),o.bbox.bottom>this.bbox.bottom-i&&(this.bbox.bottom=o.bbox.bottom+i)}pushWidget(o){if(super.pushWidget(o),this.updateBBox(o),this.widgets.length%this.columns==0){let e=Number.NEGATIVE_INFINITY;for(let s=this.widgets.length-this.columns;s<this.widgets.length;s++)this.widgets[s].bbox.bottom>e&&(e=this.widgets[s].bbox.bottom);this.cursor.x=this.bbox.left+n.layout_commons.padding,this.cursor.y=e+n.layout_commons.widget_gap;return}this.cursor.x+=m.calcWidth(this.bbox)/this.columns}render(o){o.fillStyle=b.string(n.layout_commons.bg_color),o.fillRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),o.strokeStyle=n.layout_commons.border,o.lineWidth=1,o.strokeRect(this.bbox.left,this.bbox.top,m.calcWidth(this.bbox),m.calcHeight(this.bbox)),super.render(o)}requestAction(o){const i=e=>{if(o.active_widget_loc.length===0)return!0;const s=o.active_widget_loc.slice(0,e.loc.length);return s.length===e.loc.length&&s.every((l,a)=>l===e.loc[a])};if(!o.moving_window)for(let e=0;e<this.widgets.length;e++){const s=this.widgets[e];if(!i(s))continue;const l=s.requestAction(o);if(l.wants_focus||l.action!=null)return{iters:e,...l}}return{iters:null,wants_focus:!1,action:null}}}class K{constructor(){r(this,"bbox");r(this,"widgets");this.bbox={left:0,right:0,top:0,bottom:0},this.widgets=[]}render(t){t.lineWidth=1}stack_render(t,o){for(let i=o.window_order.length-1;i>=0;i--){const e=o.window_order[i];o.window_active[e]&&this.widgets[e].render(t)}}makeWindow(t,o,i,e){const s=this.widgets.length;o.window_offsets.length<=this.widgets.length&&(o.window_offsets.push({x:0,y:0}),o.window_positions.push({x:e.x??0,y:e.y??0}),o.window_sizes.push({width:e.width??200,height:e.height??200}),o.window_active.push(!0),o.window_minimised.push(!1),o.window_order.unshift(s));const l=new q(t,i.window,i.header,i.resizeable,i.close_btn,[s],o.window_positions[s].x,o.window_positions[s].y,o.window_sizes[s].width,o.window_sizes[s].height,e.title??"Hello, World!",{width:e.min_width??50,height:e.min_height??20});return this.widgets.push(l),l}static makeGrid(t,o,i,e){const s=new bt(o,t.loc.concat([t.widgets.length]),t.cursor.x,t.cursor.y+n.layout_commons.padding,e*(t.bbox.right-t.bbox.left-2*n.layout_commons.padding),i);return t.pushWidget(s),s}endEditing(t){for(let o=0;o<this.widgets.length;o++){const i=this.widgets[o];if(t.window_active[o]&&t.window_minimised[o]&&i instanceof q){i.bbox.bottom=i.bbox.top+i.header_height;for(let e=0;e<=2;e++)if(i.widgets[e]instanceof F){i.widgets[e].window_state="minimised";break}}}}requestAction(t){this.endEditing(t);for(let o=0;o<t.window_order.length;o++){const i=t.window_order[o],e=this.widgets[i];if(t.mouse_frame.released&&(t.resizing_window=!1,document.body.style.cursor="default"),!t.window_active[i])continue;const s=e instanceof q?e.requestWindowAction(t.window_minimised[i],t):e.requestAction(t);s.wants_focus&&(t.window_order.splice(o,1),t.window_order.unshift(i));const l=s;if(e instanceof q&&l.iters!=null){if(l.resize&&(t.resizing_window=!0,document.body.style.cursor="nwse-resize"),t.resizing_window&&JSON.stringify(t.active_widget_loc)==JSON.stringify(e.widgets[l.iters].loc)){t.window_sizes[i].width+=t.window_sizes[i].width<e.min_size.width&&t.mouse_delta_pos.x<0?0:t.mouse_delta_pos.x,t.window_sizes[i].height+=t.window_sizes[i].height<e.min_size.height&&t.mouse_delta_pos.y<0?0:t.mouse_delta_pos.y;break}l.close&&(t.window_active[i]=!1),l.minimise&&(t.window_minimised[i]=!t.window_minimised[i]),t.window_minimised[i]&&(e.bbox.bottom=e.bbox.top+m.calcHeight(e.widgets[l.iters].bbox))}if(document.body.style.cursor="default",t.moving_window&&JSON.stringify(t.active_widget_loc)===JSON.stringify(e.loc)){t.mouse_frame.clicked?(t.window_order.splice(o,1),t.window_order.unshift(i),t.window_offsets[i].x=e.bbox.left-t.mouse_position.x,t.window_offsets[i].y=e.bbox.top-t.mouse_position.y):t.mouse_down&&(t.window_positions[i].x=t.window_offsets[i].x+t.mouse_position.x,t.window_positions[i].y=t.window_offsets[i].y+t.mouse_position.y);break}if(!(s.action==null&&(!m.isInside(e.bbox,t.mouse_position.x,t.mouse_position.y)||t.moving_window)))return t.mouse_frame.released&&(t.active_widget_loc=[]),s}return{wants_focus:!1,action:null}}}const G=document.createElement("style");G.type="text/css";G.appendChild(document.createTextNode(`
    @font-face {
    font-family: "Hack Regular";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Regular"), url("hack-webfont/Hack-Regular.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Italic";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Italic"), url("../hack-webfont/Hack-Italic.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Bold";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Bold"), url("../hack-webfont/Hack-Bold.woff") format("woff");
    }
    

    @font-face {
    font-family: "Hack Bold Italic";
    font-style: normal;
    font-weight: normal;
    src: local("Hack Bold Italic"), url("../hack-webfont/Hack-BoldItalic.woff") format("woff");
    }`));document.head.appendChild(G);const p=document.createElement("canvas");p.id="nvb-imgui-canvas";document.body.appendChild(p);p.style.position="absolute";p.style.top="0 px";p.style.left="0 px";function ft(){p.width=window.innerWidth,p.height=window.innerHeight,p.style.width=window.innerWidth+"px",p.style.height=window.innerHeight+"px"}function W(f,t){return Math.floor(f*10**t)/10**t}function wt(f,t){let o=f%t;return o<0&&(o+=t),o}function E(f,t,o,i){(i==null?void 0:i.min)!=null&&(i==null?void 0:i.max)!=null&&console.assert(i.min<i.max);let e=f+o*t.mouse_delta_pos.x;return(i==null?void 0:i.min)!=null&&e<(i==null?void 0:i.min)&&(e=i.min),(i==null?void 0:i.max)!=null&&e>(i==null?void 0:i.max)&&(e=i==null?void 0:i.max),e}const H=class H{static isColor(t){return typeof t==typeof H.white}static string(t){return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}static fromString(t){const o=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),?\s*(\d*\.?\d+)?\)/);if(!o)throw new Error("Invalid color string format");const[,i,e,s,l]=o;return{r:parseInt(i,10),g:parseInt(e,10),b:parseInt(s,10),a:l!==void 0?parseFloat(l):1}}static fromHex(t){const o=t.replace("#","");if(o.length===6){const i=parseInt(o.slice(0,2),16),e=parseInt(o.slice(2,4),16),s=parseInt(o.slice(4,6),16);return{r:i,g:e,b:s,a:1}}else if(o.length===8){const i=parseInt(o.slice(0,2),16),e=parseInt(o.slice(2,4),16),s=parseInt(o.slice(4,6),16),l=parseInt(o.slice(6,8),16)/255;return{r:i,g:e,b:s,a:l}}else throw new Error("Invalid hex color format")}static toHex(t){const o=Math.round(t.r).toString(16).padStart(2,"0"),i=Math.round(t.g).toString(16).padStart(2,"0"),e=Math.round(t.b).toString(16).padStart(2,"0"),s=Math.round(t.a*255).toString(16).padStart(2,"0");return t.a===1?`#${o}${i}${e}`:`#${o}${i}${e}${s}`}static fromRGB(t){return{...t,a:1}}static fromHSVA(t,o,i,e){const s=wt(t,360),l=i*o,a=l*(1-Math.abs(s/60%2-1)),h=i-l;let[w,u,x]=[0,0,0];return 0<=s&&s<60?[w,u,x]=[l,a,0]:60<=s&&s<120?[w,u,x]=[a,l,0]:120<=s&&s<180?[w,u,x]=[0,l,a]:180<=s&&s<240?[w,u,x]=[0,a,l]:240<=s&&s<300?[w,u,x]=[a,0,l]:300<=s&&s<360&&([w,u,x]=[l,0,a]),[w,u,x]=[255*(w+h),255*(u+h),255*(x+h)],{r:W(w,this.EPS_DECIMALS),g:W(u,this.EPS_DECIMALS),b:W(x,this.EPS_DECIMALS),a:e}}static toHSVA(t){const o=t.r/255,i=t.g/255,e=t.b/255,s=Math.max(o,i,e),l=Math.min(o,i,e),a=s-l;let h=0;a==0?h=0:s===o?h=(60*((i-e)/a)+360)%360:s===i?h=(60*((e-o)/a)+120)%360:s===e&&(h=(60*((o-i)/a)+240)%360);const w=s===0?0:a/s,u=s;return{h:W(h,this.EPS_DECIMALS),s:W(w,this.EPS_DECIMALS),v:W(u,this.EPS_DECIMALS),a:t.a}}};r(H,"white",{r:255,g:255,b:255,a:1}),r(H,"black",{r:0,g:0,b:0,a:1}),r(H,"g_18",{r:18,g:19,b:18,a:1}),r(H,"red",{r:255,g:0,b:0,a:1}),r(H,"default_bg"),r(H,"EPS_DECIMALS",6);let b=H;class m{static isInside(t,o,i){return o>t.left&&o<t.right&&i>t.top&&i<t.bottom}static calcWidth(t){return t.right-t.left}static calcHeight(t){return t.bottom-t.top}static set(t,o){t.left=o.left,t.right=o.right,t.top=o.top,t.bottom=o.bottom}}class n{}r(n,"font","Hack Regular"),r(n,"widget",{default_bg_color:"#666170FF",hover_bg_color:"#9992A8FF",down_bg_color:"#CCC2E0FF"}),r(n,"label",{font_size:12,default_font_color:b.white,inactive_font_color:b.fromHex("#808080FF")}),r(n,"text",{font_size:12,text_height_mult:1.5}),r(n,"button",{padding:3,font_size:12}),r(n,"layout_commons",{padding:10,widget_gap:5,bg_color:b.fromHex("#0F0F0FF0"),border:"#6E6E8080",border_width:1}),r(n,"header_commons",{color:"#ffffff",bg_color:"#4b4654",font_size:12}),r(n,"window",{minimized_header_bg:"#9F9F9F09"}),r(n,"grid",{}),r(n,"popup",{});class _t{constructor(t,o,i){r(this,"mouse_position");r(this,"mouse_prev_position");r(this,"mouse_delta_pos");r(this,"mouse_down_position");r(this,"mouse_down");r(this,"mouse_frame");r(this,"moving_window");r(this,"resizing_window");r(this,"window_offsets");r(this,"window_positions");r(this,"window_sizes");r(this,"window_active");r(this,"window_minimised");r(this,"window_order");r(this,"active_widget_loc");r(this,"action_ret_var");r(this,"last_click_time");r(this,"double_click_threshold");this.mouse_position={x:o,y:i},this.mouse_prev_position={x:o,y:i},this.mouse_down_position={x:o,y:i},this.mouse_delta_pos={x:o,y:i},this.mouse_down=!1,this.mouse_frame={clicked:!1,time_at_click:-1,time_since_click:0,double_clicked:!1,released:!1},this.moving_window=!1,this.resizing_window=!1,this.window_offsets=[],this.window_positions=[],this.window_sizes=[],this.window_active=[],this.window_minimised=[],this.window_order=[],this.active_widget_loc=[],this.last_click_time=-1,this.double_click_threshold=300,this.action_ret_var=void 0,t.addEventListener("mousemove",e=>{const s=t.getBoundingClientRect(),l=e.clientX-s.x,a=e.clientY-s.y;this.mouse_position.x=l,this.mouse_position.y=a}),t.addEventListener("mousedown",e=>{const s=t.getBoundingClientRect(),l=e.clientX-s.x,a=e.clientY-s.y;this.mouse_down_position.x=l,this.mouse_down_position.y=a;const h=performance.now();this.mouse_frame.clicked=!0,this.last_click_time!==-1&&h-this.last_click_time<this.double_click_threshold?this.mouse_frame.double_clicked=!0:(this.mouse_frame.double_clicked=!1,h-this.last_click_time>=this.double_click_threshold&&(this.last_click_time=-1)),this.last_click_time=h,this.mouse_down=!0}),t.addEventListener("mouseup",()=>{this.mouse_frame.released=!0,this.mouse_down=!1})}end(){this.mouse_delta_pos.x=this.mouse_position.x-this.mouse_prev_position.x,this.mouse_delta_pos.y=this.mouse_position.y-this.mouse_prev_position.y,this.mouse_prev_position.x=this.mouse_position.x,this.mouse_prev_position.y=this.mouse_position.y;const t=performance.now();this.mouse_frame.time_at_click!==-1&&(this.mouse_frame.time_since_click=t-this.mouse_frame.time_at_click),this.mouse_frame.clicked&&(this.mouse_frame.time_at_click=t),t-this.last_click_time>=this.double_click_threshold&&(this.mouse_frame.time_at_click=-1,this.mouse_frame.time_since_click=0,this.last_click_time=-1),this.mouse_frame.clicked=!1,this.mouse_frame.released=!1,this.mouse_frame.double_clicked=!1}}const c=p.getContext("2d"),_=new _t(p,0,0);let I=0,j=-1,Q=0,Z=-1,Y=1,tt=-1,et=-1,ot=-1,z=400,g=b.fromHex("#738C99");function nt(){document.body.style.backgroundColor=b.string(g);const f=performance.now();ft();const t=new K,o=performance.now(),i=t.makeWindow(c,_,{window:0,header:0,resizeable:0,close_btn:null},{title:"debug info",width:600,height:500});i.makeLabel(c,null,"gui-time = "+j.toFixed(2)),i.makeLabel(c,null,"frt = "+Z.toFixed(4)),i.makeLabel(c,null,"active loc = "+_.active_widget_loc),i.makeLabel(c,null,"resizing = "+_.resizing_window),i.makeLabel(c,null,"moving wind = "+_.moving_window),i.makeLabel(c,null,"make_dt = "+tt.toFixed(4)),i.makeLabel(c,null,"action_dt = "+et.toFixed(4)),i.makeLabel(c,null,"render_dt = "+ot.toFixed(4)),i.makeLabel(c,null,"active windows = "+_.window_active),i.makeLabel(c,null,"minim windows = "+_.window_minimised),i.makeLabel(c,null,"frame act = "+JSON.stringify(_.mouse_frame));const e=t.makeWindow(c,_,{window:0,header:0,resizeable:null,close_btn:null},{title:"color picker test",width:300,height:380,x:800,y:100}),s=m.calcWidth(e.bbox)-2*n.layout_commons.padding-2*n.layout_commons.widget_gap;e.makeColorPickerRect(11,b.fromHex(n.widget.default_bg_color),s+2*n.layout_commons.widget_gap,300);const l=e.makeDraggable(c,13,"H: "+Math.round(b.toHSVA(g).h),{width:1/3*s});e.cursor.x=l.bbox.right+n.layout_commons.widget_gap,e.cursor.y=l.bbox.top;const a=e.makeDraggable(c,14,"S: "+W(b.toHSVA(g).s,2),{width:1/3*s});e.cursor.x=a.bbox.right+n.layout_commons.widget_gap,e.cursor.y=a.bbox.top;const h=e.makeDraggable(c,15,"V: "+W(b.toHSVA(g).v,2),{width:1/3*s});e.cursor.x=h.bbox.right+n.layout_commons.widget_gap,e.cursor.y=h.bbox.top,e.resetCursor();const w=e.makeDraggable(c,16,"R: "+Math.round(g.r),{width:1/3*s});e.cursor.x=w.bbox.right+n.layout_commons.widget_gap,e.cursor.y=w.bbox.top;const u=e.makeDraggable(c,17,"G: "+Math.round(g.g),{width:1/3*s});e.cursor.x=u.bbox.right+n.layout_commons.widget_gap,e.cursor.y=u.bbox.top,e.makeDraggable(c,18,"B: "+Math.round(g.b),{width:1/3*s});for(let A=0;A<Y;A++)if(A==0){const d=t.makeWindow(c,_,{window:0,header:0,resizeable:0,close_btn:null},{title:"window 1",x:100,y:100}),D=m.calcWidth(d.bbox)-2*n.layout_commons.padding;d.makeButton(c,1,"Increment"),d.makeButton(c,2,"Decrement");const S=d.makeLabel(c,null,"Drag some arbitrary number:");d.cursor.y=S.bbox.top,d.cursor.x=S.bbox.right+n.layout_commons.widget_gap,d.makeDraggable(c,4,"number = "+I).bbox.bottom=S.bbox.bottom,d.resetCursor(),d.makeDraggable(c,5,"Wrap width: "+z,{width:D}),d.makeLabel(c,null," "),d.makeButton(c,3,"Add a window. "+Y),d.makeText(c,1,"Some more standard placeholder text that isn't some weird loremm ipsum shit that everyone is tired of. Wow have I offended someone with that statement. Fuck you those that are offended. I don't give a fuck",z),d.makeText(c,1,"Some more standard placeholder text that isn't some weird loremm ipsum shit that everyone is tired of.",z),d.makeButton(c,10,"Toggle window 1"),d.makeLabel(c,null," "),d.makeLabel(c,null,"* Grid => ");const y=K.makeGrid(d,0,3,1);y.makeDraggable(c,5,"g00"),y.makeDraggable(c,4,"g10"),y.makeDraggable(c,4,"g20"),y.makeDraggable(c,4,"g01"),y.makeDraggable(c,4,"g11"),y.makeDraggable(c,4,"g21"),y.makeDraggable(c,4,"g02"),y.makeDraggable(c,4,"g12"),y.makeDraggable(c,6,"g22"),d.resetCursor(),d.makeLabel(c,null,"Testing text after grid"),d.makeLabel(c,null," "),d.makeLabel(c,null,"* bg color: ");const v=" ",C=1/3*(D-2*n.layout_commons.widget_gap),O=d.makeDraggable(c,7,v+"R: "+g.r+v,{width:C});d.cursor.x=O.bbox.right+n.layout_commons.widget_gap,d.cursor.y=O.bbox.top;const R=d.makeDraggable(c,8,v+"G: "+g.g+v,{width:C});d.cursor.x=R.bbox.right+n.layout_commons.widget_gap,d.cursor.y=R.bbox.top,d.makeDraggable(c,9,v+"B: "+g.b+v,{width:C}),d.resetCursor(),d.makeLabel(c,null,"testing after rgb")}else if(A==1){const d=t.makeWindow(c,_,{window:0,header:0,resizeable:0,close_btn:0},{title:"test window with different layout modes",x:400,y:100}),[D]=[m.calcWidth(d.bbox)-n.layout_commons.padding,m.calcHeight(d.bbox)-2*n.layout_commons.padding],S=Math.min(600,Math.max(300,D))/2;d.makeDraggable(c,16,"Drag for bg r"),d.makeLabel(c,null,"Two column mode: "),d.setMode("two columns",{min_width:300,max_width:600}),d.makeLabel(c,null,"some left side text"),d.makeLabel(c,null,"some right text"),d.makeButton(c,1,"Increment",{width:100,height:50}),d.makeButton(c,2,"Decrement"),d.makeColorPickerRect(12,g,S,S),d.makeText(c,null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",S-10)}tt=performance.now()-o;const k=performance.now(),B=t.requestAction(_);switch(et=performance.now()-k,B.action){case 1:I++;break;case 2:I--;break;case 3:Y++;break;case 4:I+=_.mouse_delta_pos.x,I<-100&&(I=-100),I>100&&(I=100);break;case 5:z+=_.mouse_delta_pos.x,z<0&&(z=0);break;case 6:z+=2*_.mouse_delta_pos.x,z<0&&(z=0);break;case 7:g.r+=_.mouse_delta_pos.x;break;case 8:g.g+=_.mouse_delta_pos.x;break;case 9:g.b+=_.mouse_delta_pos.x;break;case 10:_.window_active[2]=!_.window_active[2];break;case 11:b.isColor(_.action_ret_var)&&(n.widget.default_bg_color=b.toHex(_.action_ret_var));break;case 13:let{h:A,s:d,v:D,a:S}=b.toHSVA(g);A=E(A,_,1),g=b.fromHSVA(A,d,D,S);break;case 14:let{h:y,s:v,v:C,a:O}=b.toHSVA(g);v=E(v,_,.005,{min:0,max:1}),g=b.fromHSVA(y,v,C,O);break;case 15:let{h:R,s:lt,v:$,a:rt}=b.toHSVA(g);$=E($,_,.005,{min:0,max:1}),g=b.fromHSVA(R,lt,$,rt);break;case 16:g.r=E(g.r,_,1,{min:0,max:255});break;case 17:g.g=E(g.g,_,1,{min:0,max:255});break;case 18:g.b=E(g.b,_,1,{min:0,max:255});break;case 12:b.isColor(_.action_ret_var)&&(g=_.action_ret_var)}const N=performance.now();c.clearRect(0,0,p.width,p.height),t.stack_render(c,_),ot=performance.now()-N,_.end();const J=performance.now();j=J-f,Z=J-Q,Q=J,requestAnimationFrame(nt)}nt();
